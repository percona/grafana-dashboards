{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"lodash\"","webpack:///external \"moment\"","webpack:///external \"jquery\"","webpack:///external \"app/core/app_events\"","webpack:///external \"@grafana/data\"","webpack:///external \"app/core/utils/kbn\"","webpack:///external \"app/plugins/sdk\"","webpack:///../node_modules/tslib/tslib.es6.js","webpack:///./canvas-metric.ts","webpack:///./distinct-points.ts","webpack:///./module.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__WEBPACK_EXTERNAL_MODULE__0__","__WEBPACK_EXTERNAL_MODULE__1__","__WEBPACK_EXTERNAL_MODULE__2__","__WEBPACK_EXTERNAL_MODULE__3__","__WEBPACK_EXTERNAL_MODULE__4__","__WEBPACK_EXTERNAL_MODULE__5__","__WEBPACK_EXTERNAL_MODULE__6__","extendStatics","b","setPrototypeOf","__proto__","Array","__extends","__","this","constructor","__values","iterator","length","next","done","TypeError","$scope","$injector","data","mouse","position","down","$tooltip","events","on","onPanelInitialized","onRefresh","onRender","_devicePixelRatio","undefined","window","devicePixelRatio","render","context","console","log","rect","wrap","getBoundingClientRect","height","Math","max","width","canvas","centerV","ctx","lineWidth","textBaseline","time","dashboard","formatDate","ts","fillStyle","fillRect","font","textAlign","fillText","xmin","min","x","xmax","globalCompositeOperation","beginPath","fill","strokeStyle","moveTo","lineTo","stroke","clearTT","detach","getMousePosition","evt","elapsed","range","to","from","offsetX","parseFloat","y","clientY","top","yRel","onGraphHover","showTT","isExternal","onMouseClicked","where","event","onMouseSelectedRange","link","scope","elem","attrs","ctrl","find","document","createElement","appendChild","css","getContext","addEventListener","info","pos","pageX","pageY","panelRelY","panelRelX","xRel","panel","a","emit","buttons","up","utc","isThis","id","sharedTooltipModeEnabled","otherPanelInFullscreenMode","gevt","sharedCrosshairModeOnly","time_format","secPerTick","getTimeResolution","estTimeInterval","timeIntInSecs","roundDate","timeStamp","roundee","fmt","monthNames","dayNames","strftime","hours12","escape","hours","getHours","isAM","charAt","getDay","getMonth","leftPad","getDate","getMinutes","floor","getSeconds","getFullYear","push","join","pad","changes","legendInfo","last","asc","transitionCount","distinctValuesCount","add","val","start","ms","finish","reverse","until","distinct","Map","pt","e","has","v","count","set","per","forEach","size","isTimeline","orderBy","combineLegend","merged","DistinctPoints","leg","grafanaColors","annotationsSrv","defaults","display","rowHeight","valueMaps","op","text","rangeMaps","colorMaps","color","metricNameColor","valueTextColor","timeTextColor","crosshairColor","backgroundColor","lineColor","textSize","textSizeTime","extendLastValue","writeLastValue","writeAllValues","writeMetricNames","showTimeAxis","showLegend","showLegendNames","showLegendValues","showLegendPercent","highlightOnMouseover","expandFromQueryS","legendSortBy","units","timeOptions","timePrecision","useTimePrecision","use12HourClock","annotations","legend","externalPT","isStacked","hoverPoint","colorMap","unitFormats","formatter","_colorsPaleteCash","_renderDimensions","_selectionMatrix","fieldNamer","field","frame","allFrames","config","displayName","defaultsDeep","onInitEditMode","useDataFrames","onDataFramesReceived","onSnapshotLoad","onDataError","type","number","values","err","warn","updateColorInfo","onConfigChanged","getUnitFormats","addEditorTab","editorTabIndex","refresh","_updateRenderDimensions","_updateSelectionMatrix","_updateCanvasSize","_renderRects","_renderTimeAxis","_renderLabels","_renderAnnotations","_renderSelection","_renderCrosshair","renderingCompleted","showLegandTooltip","body","formatDuration","duration","html","place_tt","formatValue","isNumber","map","decimals","isNull","isNil","isString","toString","getColor","randomColor","letters","split","random","applyPanelTimeOverrides","subtract","raw","dataList","getProcessedDataFrames","frames","timeField","fields","res","updateLegendMetrics","getAnnotations","then","result","loading","notify","removeColorMap","index","indexOf","splice","cm","addColorMap","what","metric","removeValueMap","addValueMap","removeRangeMap","rangeMap","addRangeMap","update","valueFormats","humanize","dir","hasValue","limit","parseInt","as","rs","keys","reduce","carry","replace","substr","getLegendDisplay","disp","showLegendCounts","showLegendTime","hassomething","dec","legendPercentDecimals","percentunit","showTooltip","point","timeformat","innerHeight","scrollTop","pX","left","getCorrectTime","valueOf","hover","j","rowsHeight","isUndefined","anno","isRegion","timeEnd","annoX","mouseX","metaKey","ctrlKey","timeSrv","setTime","clear","rows","timeHeight","matrix","positions","predicate","all","crosshairHover","row","_selectedMetric","legendItem","_selectedLegendItem","_getVal","getPredicate","scale","metricIndex","rectIndex","rowObj","currentX","nextX","globalAlphaTemp","globalAlpha","centerY","labelPositionMetricName","labelPositionLastValue","labelPositionValue","minTextSpot","maxTextSpot","measureText","hoverTextStart","hoverTextEnd","txtinfo","save","clip","restore","strokeRect","setLineDash","lineDashOffset","timeResolution","pixelStep","nextPointInTime","xPos","timeFormat","displayOffset","getTimezone","Date","getTimezoneOffset","date","dateStr","xOffset","arc","PI","isAlert","source","iconColor","annotation","_drawVertical","xPosStart","xPosEnd","timeVal","headerColumnIndent","templateUrl","scrollable","results","dataFrames","dataFrame","f","calcs","state"],"mappings":"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","file":"module.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","module.exports = __WEBPACK_EXTERNAL_MODULE__2__;","module.exports = __WEBPACK_EXTERNAL_MODULE__3__;","module.exports = __WEBPACK_EXTERNAL_MODULE__4__;","module.exports = __WEBPACK_EXTERNAL_MODULE__5__;","module.exports = __WEBPACK_EXTERNAL_MODULE__6__;","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { MetricsPanelCtrl } from 'grafana/app/plugins/sdk';\n\n/* eslint-disable id-blacklist, no-restricted-imports, @typescript-eslint/ban-types */\nimport moment from 'moment';\n\nimport $ from 'jquery';\n\nimport appEvents from 'grafana/app/core/app_events';\n\n// Expects a template with:\n// <div class=\"canvas-spot\"></div>\nexport class CanvasPanelCtrl extends MetricsPanelCtrl {\n  data: any;\n  mouse: any;\n  $tooltip: any;\n  wrap: any;\n  canvas: any;\n  context: any;\n  _devicePixelRatio: number;\n\n  /** @ngInject */\n  constructor($scope, $injector) {\n    super($scope, $injector);\n\n    this.data = null;\n    this.mouse = {\n      position: null,\n      down: null,\n    };\n    this.$tooltip = $('<div class=\"graph-tooltip\">');\n\n    this.events.on('panel-initialized', this.onPanelInitialized.bind(this));\n    this.events.on('refresh', this.onRefresh.bind(this));\n    this.events.on('render', this.onRender.bind(this));\n\n    this._devicePixelRatio = 1;\n    if (window.devicePixelRatio !== undefined) {\n      this._devicePixelRatio = window.devicePixelRatio;\n    }\n  }\n\n  onPanelInitialized() {\n    //console.log(\"onPanelInitalized()\");\n    this.render();\n  }\n\n  onRefresh() {\n    //console.log(\"onRefresh()\");\n    this.render();\n  }\n\n  // Typically you will override this\n  onRender() {\n    if (!this.context) {\n      console.log('No context!');\n      return;\n    }\n    console.log('canvas render', this.mouse);\n\n    const rect = this.wrap.getBoundingClientRect();\n\n    const height = Math.max(this.height, 100);\n    const width = rect.width;\n    this.canvas.width = width;\n    this.canvas.height = height;\n\n    const centerV = height / 2;\n\n    const ctx = this.context;\n    ctx.lineWidth = 1;\n    ctx.textBaseline = 'middle';\n\n    let time = '';\n    if (this.mouse.position != null) {\n      time = this.dashboard.formatDate(moment(this.mouse.position.ts));\n    }\n\n    ctx.fillStyle = '#999999';\n    ctx.fillRect(0, 0, width, height);\n    ctx.fillStyle = '#111111';\n    ctx.font = '24px \"Open Sans\", Helvetica, Arial, sans-serif';\n    ctx.textAlign = 'left';\n    ctx.fillText('Mouse @ ' + time, 10, centerV);\n\n    if (this.mouse.position != null) {\n      if (this.mouse.down != null) {\n        const xmin = Math.min(this.mouse.position.x, this.mouse.down.x);\n        const xmax = Math.max(this.mouse.position.x, this.mouse.down.x);\n\n        // Fill canvas using 'destination-out' and alpha at 0.05\n        ctx.globalCompositeOperation = 'destination-out';\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';\n        ctx.beginPath();\n        ctx.fillRect(0, 0, xmin, height);\n        ctx.fill();\n\n        ctx.beginPath();\n        ctx.fillRect(xmax, 0, width, height);\n        ctx.fill();\n        ctx.globalCompositeOperation = 'source-over';\n      } else {\n        ctx.strokeStyle = '#111';\n        ctx.beginPath();\n        ctx.moveTo(this.mouse.position.x, 0);\n        ctx.lineTo(this.mouse.position.x, height);\n        ctx.lineWidth = 3;\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.moveTo(this.mouse.position.x, 0);\n        ctx.lineTo(this.mouse.position.x, height);\n        ctx.strokeStyle = '#e22c14';\n        ctx.lineWidth = 2;\n        ctx.stroke();\n      }\n    }\n  }\n\n  clearTT() {\n    this.$tooltip.detach();\n  }\n\n  getMousePosition(evt) {\n    const elapsed = this.range.to - this.range.from;\n    const rect = this.canvas.getBoundingClientRect();\n    const x = evt.offsetX; // - rect.left;\n    const ts = this.range.from + elapsed * (x / parseFloat(rect.width));\n    const y = evt.clientY - rect.top;\n\n    return {\n      x: x,\n      y: y,\n      yRel: y / parseFloat(rect.height),\n      ts: ts,\n      evt: evt,\n    };\n  }\n\n  onGraphHover(evt, showTT, isExternal) {\n    console.log('HOVER', evt, showTT, isExternal);\n  }\n\n  onMouseClicked(where, event) {\n    console.log('CANVAS CLICKED', where, event);\n    this.render();\n  }\n\n  onMouseSelectedRange(range, event) {\n    console.log('CANVAS Range', range, event);\n  }\n\n  link(scope, elem, attrs, ctrl) {\n    this.wrap = elem.find('.canvas-spot')[0];\n    this.canvas = document.createElement('canvas');\n    this.wrap.appendChild(this.canvas);\n\n    $(this.canvas).css('cursor', 'pointer');\n    $(this.wrap).css('width', '100%');\n\n    //  console.log( 'link', this );\n\n    this.context = this.canvas.getContext('2d');\n    this.canvas.addEventListener(\n      'mousemove',\n      evt => {\n        if (!this.range) {\n          return; // skip events before we have loaded\n        }\n\n        this.mouse.position = this.getMousePosition(evt);\n        const info = {\n          pos: {\n            pageX: evt.pageX,\n            pageY: evt.pageY,\n            x: this.mouse.position.ts,\n            y: this.mouse.position.y,\n            panelRelY: this.mouse.position.yRel,\n            panelRelX: this.mouse.position.xRel,\n          },\n          evt: evt,\n          panel: this.panel,\n        };\n        appEvents.emit('graph-hover', info);\n        if (this.mouse.down != null) {\n          $(this.canvas).css('cursor', 'col-resize');\n        }\n      },\n      false\n    );\n\n    this.canvas.addEventListener(\n      'mouseout',\n      evt => {\n        if (this.mouse.down == null) {\n          this.mouse.position = null;\n          this.onRender();\n          this.$tooltip.detach();\n          appEvents.emit('graph-hover-clear');\n        }\n      },\n      false\n    );\n\n    this.canvas.addEventListener(\n      'mousedown',\n      evt => {\n        this.mouse.down = this.getMousePosition(evt);\n      },\n      false\n    );\n\n    this.canvas.addEventListener(\n      'mouseenter',\n      evt => {\n        if (this.mouse.down && !evt.buttons) {\n          this.mouse.position = null;\n          this.mouse.down = null;\n          this.onRender();\n          this.$tooltip.detach();\n          appEvents.emit('graph-hover-clear');\n        }\n        $(this.canvas).css('cursor', 'pointer');\n      },\n      false\n    );\n\n    this.canvas.addEventListener(\n      'mouseup',\n      evt => {\n        this.$tooltip.detach();\n        const up = this.getMousePosition(evt);\n        if (this.mouse.down != null) {\n          if (up.x === this.mouse.down.x && up.y === this.mouse.down.y) {\n            this.mouse.position = null;\n            this.mouse.down = null;\n            this.onMouseClicked(up, evt);\n          } else {\n            const min = Math.min(this.mouse.down.ts, up.ts);\n            const max = Math.max(this.mouse.down.ts, up.ts);\n            const range = { from: moment.utc(min), to: moment.utc(max) };\n            this.mouse.position = up;\n            this.onMouseSelectedRange(range, evt);\n          }\n        }\n        this.mouse.down = null;\n        this.mouse.position = null;\n      },\n      false\n    );\n\n    this.canvas.addEventListener(\n      'dblclick',\n      evt => {\n        this.mouse.position = null;\n        this.mouse.down = null;\n        this.onRender();\n        this.$tooltip.detach();\n        appEvents.emit('graph-hover-clear');\n\n        console.log('TODO, ZOOM OUT');\n      },\n      true\n    );\n\n    // global events\n    appEvents.on(\n      'graph-hover',\n      event => {\n        // ignore other graph hover events if shared tooltip is disabled\n        const isThis = event.panel.id === this.panel.id;\n        if (!this.dashboard.sharedTooltipModeEnabled() && !isThis) {\n          return;\n        }\n\n        // ignore if other panels are fullscreen\n        if (this.otherPanelInFullscreenMode()) {\n          return;\n        }\n\n        // Calculate the mouse position when it came from somewhere else\n        if (!isThis) {\n          if (!event.pos.x || !this.range) {\n            // NOTE, this happens when a panel has no data\n            // console.log('Invalid hover point', event);\n            return;\n          }\n\n          const ts = event.pos.x;\n          const rect = this.canvas.getBoundingClientRect();\n          const elapsed = this.range.to - this.range.from;\n          const x = ((ts - this.range.from) / elapsed) * rect.width;\n\n          this.mouse.position = {\n            x: x,\n            y: event.pos.panelRelY * rect.height,\n            yRel: event.pos.panelRelY,\n            ts: ts,\n            gevt: event,\n          };\n          //console.log( \"Calculate mouseInfo\", event, this.mouse.position);\n        }\n\n        this.onGraphHover(event, isThis || !this.dashboard.sharedCrosshairModeOnly(), !isThis);\n      },\n      scope\n    );\n\n    appEvents.on(\n      'graph-hover-clear',\n      (event, info) => {\n        this.mouse.position = null;\n        this.mouse.down = null;\n        this.render();\n        this.$tooltip.detach();\n      },\n      scope\n    );\n\n    // scope.$on('$destroy', () => {\n    //   this.$tooltip.destroy();\n    //   elem.off();\n    //   elem.remove();\n    // });\n  }\n\n  // Utility Functions for time axis\n  //---------------------------------\n\n  time_format(range: number, secPerTick: number): string {\n    const oneDay = 86400000;\n    const oneYear = 31536000000;\n\n    if (secPerTick <= 45) {\n      return '%H:%M:%S';\n    }\n    if (secPerTick <= 7200 || range <= oneDay) {\n      return '%H:%M';\n    }\n    if (secPerTick <= 80000) {\n      return '%m/%d %H:%M';\n    }\n    if (secPerTick <= 2419200 || range <= oneYear) {\n      return '%m/%d';\n    }\n    return '%Y-%m';\n  }\n\n  getTimeResolution(estTimeInterval: number): number {\n    const timeIntInSecs = estTimeInterval / 1000;\n\n    if (timeIntInSecs <= 30) {\n      return 30 * 1000;\n    }\n\n    if (timeIntInSecs <= 60) {\n      return 60 * 1000;\n    }\n\n    if (timeIntInSecs <= 60 * 5) {\n      return 5 * 60 * 1000;\n    }\n\n    if (timeIntInSecs <= 60 * 10) {\n      return 10 * 60 * 1000;\n    }\n\n    if (timeIntInSecs <= 60 * 30) {\n      return 30 * 60 * 1000;\n    }\n\n    if (timeIntInSecs <= 60 * 60) {\n      return 60 * 60 * 1000;\n    }\n\n    if (timeIntInSecs <= 60 * 60) {\n      return 60 * 60 * 1000;\n    }\n\n    if (timeIntInSecs <= 2 * 60 * 60) {\n      return 2 * 60 * 60 * 1000;\n    }\n\n    if (timeIntInSecs <= 6 * 60 * 60) {\n      return 6 * 60 * 60 * 1000;\n    }\n\n    if (timeIntInSecs <= 12 * 60 * 60) {\n      return 12 * 60 * 60 * 1000;\n    }\n\n    if (timeIntInSecs <= 24 * 60 * 60) {\n      return 24 * 60 * 60 * 1000;\n    }\n\n    if (timeIntInSecs <= 2 * 24 * 60 * 60) {\n      return 2 * 24 * 60 * 60 * 1000;\n    }\n\n    if (timeIntInSecs <= 7 * 24 * 60 * 60) {\n      return 7 * 24 * 60 * 60 * 1000;\n    }\n\n    if (timeIntInSecs <= 30 * 24 * 60 * 60) {\n      return 30 * 24 * 60 * 60 * 1000;\n    }\n\n    return 6 * 30 * 24 * 60 * 60 * 1000;\n  }\n\n  roundDate(timeStamp, roundee) {\n    timeStamp -= timeStamp % roundee; //subtract amount of time since midnight\n    return timeStamp;\n  }\n\n  formatDate(d, fmt) {\n    const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n    if (typeof d.strftime === 'function') {\n      return d.strftime(fmt);\n    }\n\n    const r: string[] = [];\n    let escape = false;\n    const hours = d.getHours();\n    const isAM = hours < 12;\n    let hours12;\n\n    if (hours > 12) {\n      hours12 = hours - 12;\n    } else if (hours === 0) {\n      hours12 = 12;\n    } else {\n      hours12 = hours;\n    }\n\n    for (let i = 0; i < fmt.length; ++i) {\n      let c = fmt.charAt(i);\n\n      if (escape) {\n        switch (c) {\n          case 'a':\n            c = '' + dayNames[d.getDay()];\n            break;\n          case 'b':\n            c = '' + monthNames[d.getMonth()];\n            break;\n          case 'd':\n            c = this.leftPad(d.getDate(), '');\n            break;\n          case 'e':\n            c = this.leftPad(d.getDate(), ' ');\n            break;\n          case 'h': // For back-compat with 0.7; remove in 1.0\n          case 'H':\n            c = this.leftPad(hours, null);\n            break;\n          case 'I':\n            c = this.leftPad(hours12, null);\n            break;\n          case 'l':\n            c = this.leftPad(hours12, ' ');\n            break;\n          case 'm':\n            c = this.leftPad(d.getMonth() + 1, '');\n            break;\n          case 'M':\n            c = this.leftPad(d.getMinutes(), null);\n            break;\n          // quarters not in Open Group's strftime specification\n          case 'q':\n            c = '' + (Math.floor(d.getMonth() / 3) + 1);\n            break;\n          case 'S':\n            c = this.leftPad(d.getSeconds(), null);\n            break;\n          case 'y':\n            c = this.leftPad(d.getFullYear() % 100, null);\n            break;\n          case 'Y':\n            c = '' + d.getFullYear();\n            break;\n          case 'p':\n            c = isAM ? '' + 'am' : '' + 'pm';\n            break;\n          case 'P':\n            c = isAM ? '' + 'AM' : '' + 'PM';\n            break;\n          case 'w':\n            c = '' + d.getDay();\n            break;\n        }\n        r.push(c);\n        escape = false;\n      } else {\n        if (c === '%') {\n          escape = true;\n        } else {\n          r.push(c);\n        }\n      }\n    }\n\n    return r.join('');\n  }\n\n  leftPad(n, pad) {\n    n = '' + n;\n    pad = '' + (pad == null ? '0' : pad);\n    return n.length === 1 ? pad + n : n;\n  }\n}\n","import _ from 'lodash';\n\nexport class PointInfo {\n  val: string;\n  start: number; // timestamp\n  ms = 0; // elapsed time\n\n  constructor(val: string, start: number) {\n    this.val = val;\n    this.start = start;\n  }\n}\n\nexport class LegendValue {\n  val: string;\n  ms = 0; // elapsed time\n  count = 0;\n  per = 0;\n\n  constructor(val: string) {\n    this.val = val;\n  }\n}\n\nexport class DistinctPoints {\n  changes: PointInfo[] = [];\n  legendInfo: LegendValue[] = [];\n  last: PointInfo | null = null;\n  asc = false;\n  transitionCount = 0;\n  distinctValuesCount = 0;\n  elapsed = 0;\n\n  constructor(public name) {}\n\n  // ts numeric ms,\n  // val is the normalized value\n  add(ts: number, val: string) {\n    if (this.last == null) {\n      this.last = {\n        val: val,\n        start: ts,\n        ms: 0,\n      };\n      this.changes.push(this.last);\n    } else if (ts === this.last.start) {\n      console.log('skip point with duplicate timestamp', ts, val);\n      return;\n    } else {\n      if (this.changes.length === 1) {\n        this.asc = ts > this.last.start;\n      }\n\n      if (ts > this.last.start !== this.asc) {\n        console.log('skip out of order point', ts, val);\n        return;\n      }\n\n      // Same value\n      if (val === this.last.val) {\n        if (!this.asc) {\n          this.last.start = ts;\n        }\n      } else {\n        this.last = {\n          val: val,\n          start: ts,\n          ms: 0,\n        };\n        this.changes.push(this.last);\n      }\n    }\n  }\n\n  finish(ctrl) {\n    if (this.changes.length < 1) {\n      console.log('no points found!');\n      return;\n    }\n\n    if (!this.asc) {\n      this.last = this.changes[0];\n      _.reverse(this.changes);\n    }\n\n    if (!this.last) {\n      return;\n    }\n\n    // Add a point beyond the controls\n    if (this.last.start < ctrl.range.to) {\n      const until = ctrl.range.to + 1;\n      // let now = Date.now();\n      // if(this.last.start < now && ctrl.range.to > now) {\n      //   until = now;\n      // }\n\n      // This won't be shown, but will keep the count consistent\n      this.changes.push({\n        val: this.last.val,\n        start: until,\n        ms: 0,\n      });\n    }\n\n    this.transitionCount = 0;\n    const distinct = new Map<string, LegendValue>();\n    let last: PointInfo = this.changes[0];\n    for (let i = 1; i < this.changes.length; i++) {\n      const pt = this.changes[i];\n\n      let s = last.start;\n      let e = pt.start;\n      if (s < ctrl.range.from) {\n        s = ctrl.range.from;\n      } else if (s < ctrl.range.to) {\n        this.transitionCount++;\n      }\n\n      if (e > ctrl.range.to) {\n        e = ctrl.range.to;\n      }\n\n      last.ms = e - s;\n      if (last.ms > 0) {\n        if (distinct.has(last.val)) {\n          const v = distinct.get(last.val)!;\n          v.ms += last.ms;\n          v.count++;\n        } else {\n          distinct.set(last.val, { val: last.val, ms: last.ms, count: 1, per: 0 });\n        }\n      }\n      last = pt;\n    }\n\n    const elapsed = ctrl.range.to - ctrl.range.from;\n    this.elapsed = elapsed;\n\n    distinct.forEach((value: LegendValue, key: any) => {\n      value.per = value.ms / elapsed;\n      this.legendInfo.push(value);\n    });\n    this.distinctValuesCount = _.size(this.legendInfo);\n\n    if (!ctrl.isTimeline) {\n      this.legendInfo = _.orderBy(this.legendInfo, ['ms'], ['desc']);\n    }\n  }\n\n  static combineLegend(data: DistinctPoints[], ctrl: any): DistinctPoints {\n    if (data.length === 1) {\n      return data[0];\n    }\n\n    const merged: DistinctPoints = new DistinctPoints('merged');\n    let elapsed = 0;\n    const distinct = new Map<string, LegendValue>();\n    _.forEach(data, (m: DistinctPoints) => {\n      merged.transitionCount += m.transitionCount;\n      elapsed += m.elapsed;\n\n      _.forEach(m.legendInfo, (leg: LegendValue) => {\n        if (distinct.has(leg.val)) {\n          const v = distinct.get(leg.val)!;\n          v.ms += leg.ms;\n          v.count += leg.count;\n          // per gets recalculated at the end\n        } else {\n          distinct.set(leg.val, { val: leg.val, ms: leg.ms, count: leg.count, per: 0 });\n        }\n      });\n    });\n\n    merged.elapsed = elapsed;\n    distinct.forEach((value: LegendValue, key: any) => {\n      value.per = value.ms / elapsed;\n      merged.legendInfo.push(value);\n    });\n    merged.distinctValuesCount = _.size(merged.legendInfo);\n    return merged;\n  }\n}\n","import { CanvasPanelCtrl } from './canvas-metric';\nimport { DistinctPoints, LegendValue } from './distinct-points';\nimport { isArray } from 'lodash';\n\nimport {\n  DataQueryResponseData,\n  LegacyResponseData,\n  DataFrame,\n  guessFieldTypes,\n  toDataFrame,\n  getTimeField,\n  getFieldDisplayName,\n  Field,\n  ArrayVector,\n  FieldType,\n} from '@grafana/data';\n\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport kbn from 'grafana/app/core/utils/kbn';\n\nimport appEvents from 'grafana/app/core/app_events';\n\n/* eslint-disable id-blacklist, no-restricted-imports, @typescript-eslint/ban-types */\nimport moment from 'moment';\n\nconst grafanaColors = [\n  '#7EB26D',\n  '#EAB839',\n  '#6ED0E0',\n  '#EF843C',\n  '#E24D42',\n  '#1F78C1',\n  '#BA43A9',\n  '#705DA0',\n  '#508642',\n  '#CCA300',\n  '#447EBC',\n  '#C15C17',\n  '#890F02',\n  '#0A437C',\n  '#6D1F62',\n  '#584477',\n  '#B7DBAB',\n  '#F4D598',\n  '#70DBED',\n  '#F9BA8F',\n  '#F29191',\n  '#82B5D8',\n  '#E5A8E2',\n  '#AEA2E0',\n  '#629E51',\n  '#E5AC0E',\n  '#64B0C8',\n  '#E0752D',\n  '#BF1B00',\n  '#0A50A1',\n  '#962D82',\n  '#614D93',\n  '#9AC48A',\n  '#F2C96D',\n  '#65C5DB',\n  '#F9934E',\n  '#EA6460',\n  '#5195CE',\n  '#D683CE',\n  '#806EB7',\n  '#3F6833',\n  '#967302',\n  '#2F575E',\n  '#99440A',\n  '#58140C',\n  '#052B51',\n  '#511749',\n  '#3F2B5B',\n  '#E0F9D7',\n  '#FCEACA',\n  '#CFFAFF',\n  '#F9E2D2',\n  '#FCE2DE',\n  '#BADFF4',\n  '#F9D9F9',\n  '#DEDAF7',\n]; // copied from public/app/core/utils/colors.ts because of changes in grafana 4.6.0\n//(https://github.com/grafana/grafana/blob/master/PLUGIN_DEV.md)\n\nclass DiscretePanelCtrl extends CanvasPanelCtrl {\n  static templateUrl = 'partials/module.html';\n  static scrollable = true;\n\n  defaults = {\n    display: 'timeline', // or 'stacked'\n    rowHeight: 50,\n    valueMaps: [{ value: 'null', op: '=', text: 'N/A' }],\n    rangeMaps: [{ from: 'null', to: 'null', text: 'N/A' }],\n    colorMaps: [{ text: 'N/A', color: '#CCC' }],\n    metricNameColor: '#000000',\n    valueTextColor: '#000000',\n    timeTextColor: '#d8d9da',\n    crosshairColor: '#8F070C',\n    backgroundColor: 'rgba(128,128,128,0.1)',\n    lineColor: 'rgba(0,0,0,0.1)',\n    textSize: 24,\n    textSizeTime: 12,\n    extendLastValue: true,\n    writeLastValue: true,\n    writeAllValues: false,\n    writeMetricNames: false,\n    showTimeAxis: true,\n    showLegend: true,\n    showLegendNames: true,\n    showLegendValues: true,\n    showLegendPercent: true,\n    highlightOnMouseover: true,\n    expandFromQueryS: 0,\n    legendSortBy: '-ms',\n    units: 'short',\n    timeOptions: [\n      {\n        name: 'Years',\n        value: 'years',\n      },\n      {\n        name: 'Months',\n        value: 'months',\n      },\n      {\n        name: 'Weeks',\n        value: 'weeks',\n      },\n      {\n        name: 'Days',\n        value: 'days',\n      },\n      {\n        name: 'Hours',\n        value: 'hours',\n      },\n      {\n        name: 'Minutes',\n        value: 'minutes',\n      },\n      {\n        name: 'Seconds',\n        value: 'seconds',\n      },\n      {\n        name: 'Milliseconds',\n        value: 'milliseconds',\n      },\n    ],\n    timePrecision: {\n      name: 'Minutes',\n      value: 'minutes',\n    },\n    useTimePrecision: false,\n    use12HourClock: false,\n  };\n\n  annotations: any = [];\n  data: DistinctPoints[] = [];\n  legend: DistinctPoints[] = [];\n\n  externalPT = false;\n  isTimeline = true;\n  isStacked = false;\n  hoverPoint: any = null;\n  colorMap: any = {};\n  unitFormats: any = null; // only used for editor\n  formatter: any = null;\n\n  _colorsPaleteCash: any = null;\n  _renderDimensions: any = {};\n  _selectionMatrix: string[][] = [];\n\n  fieldNamer = (field: Field, frame?: DataFrame, allFrames?: DataFrame[]): string => {\n    if (field.config.displayName) {\n      return field.config.displayName;\n    }\n    return field.name;\n  };\n\n  /** @ngInject */\n  constructor($scope, $injector, public annotationsSrv) {\n    super($scope, $injector);\n\n    // defaults configs\n    _.defaultsDeep(this.panel, this.defaults);\n    this.panel.display = 'timeline'; // Only supported version now\n\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('render', this.onRender.bind(this));\n    this.events.on('refresh', this.onRefresh.bind(this));\n\n    // 6.4+ use DataFrames\n    (this as any).useDataFrames = true;\n    this.events.on('data-frames-received', this.onDataFramesReceived.bind(this));\n    this.events.on('data-snapshot-load', this.onSnapshotLoad.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n    // Try to load the 7+ naming strategy\n    try {\n      const a = getFieldDisplayName({ name: 'a', config: {}, type: FieldType.number, values: new ArrayVector([]) });\n      if (a === 'a') {\n        this.fieldNamer = getFieldDisplayName;\n      }\n    } catch (err) {\n      console.warn('Using 6x style field names', err);\n    }\n  }\n\n  onPanelInitialized() {\n    this.updateColorInfo();\n    this.onConfigChanged();\n  }\n\n  onDataError(err) {\n    this.annotations = [];\n    console.log('onDataError', err);\n  }\n\n  onInitEditMode() {\n    this.unitFormats = kbn.getUnitFormats();\n\n    this.addEditorTab('Options', 'public/plugins/natel-discrete-panel/partials/editor.options.html', 1);\n    this.addEditorTab('Legend', 'public/plugins/natel-discrete-panel/partials/editor.legend.html', 3);\n    this.addEditorTab('Colors', 'public/plugins/natel-discrete-panel/partials/editor.colors.html', 4);\n    this.addEditorTab('Mappings', 'public/plugins/natel-discrete-panel/partials/editor.mappings.html', 5);\n    this.editorTabIndex = 1;\n    this.refresh();\n  }\n\n  onRender() {\n    if (this.data == null || !this.context) {\n      return;\n    }\n\n    this._updateRenderDimensions();\n    this._updateSelectionMatrix();\n    this._updateCanvasSize();\n    this._renderRects();\n    this._renderTimeAxis();\n    this._renderLabels();\n    this._renderAnnotations();\n    this._renderSelection();\n    this._renderCrosshair();\n\n    this.renderingCompleted();\n  }\n\n  showLegandTooltip(pos, info) {\n    let body = '<div class=\"graph-tooltip-time\">' + info.val + '</div>';\n\n    body += '<center>';\n    if (info.count > 1) {\n      body += info.count + ' times<br/>for<br/>';\n    }\n\n    body += this.formatDuration(moment.duration(info.ms));\n\n    if (info.count > 1) {\n      body += '<br/>total';\n    }\n    body += '</center>';\n\n    this.$tooltip.html(body).place_tt(pos.pageX + 20, pos.pageY);\n  }\n\n  clearTT() {\n    this.$tooltip.detach();\n  }\n\n  formatValue(val): string {\n    if (_.isNumber(val)) {\n      if (this.panel.rangeMaps) {\n        for (let i = 0; i < this.panel.rangeMaps.length; i++) {\n          const map = this.panel.rangeMaps[i];\n\n          // value/number to range mapping\n          const from = parseFloat(map.from);\n          const to = parseFloat(map.to);\n          if (to >= val && from <= val) {\n            return map.text;\n          }\n        }\n      }\n\n      // Convert it to a string first\n      if (this.formatter) {\n        val = this.formatter(val, this.panel.decimals);\n      }\n    }\n\n    const isNull = _.isNil(val);\n    if (!isNull && !_.isString(val)) {\n      val = val.toString(); // convert everything to a string\n    }\n\n    for (let i = 0; i < this.panel.valueMaps.length; i++) {\n      const map = this.panel.valueMaps[i];\n      // special null case\n      if (map.value === 'null') {\n        if (isNull) {\n          return map.text;\n        }\n        continue;\n      }\n\n      if (val === map.value) {\n        return map.text;\n      }\n    }\n\n    if (isNull) {\n      return 'null';\n    }\n    return val;\n  }\n\n  getColor(val) {\n    if (_.has(this.colorMap, val)) {\n      return this.colorMap[val];\n    }\n    if (this._colorsPaleteCash[val] === undefined) {\n      const c = grafanaColors[this._colorsPaleteCash.length % grafanaColors.length];\n      this._colorsPaleteCash[val] = c;\n      this._colorsPaleteCash.length++;\n    }\n    return this._colorsPaleteCash[val];\n  }\n\n  randomColor() {\n    const letters = 'ABCDE'.split('');\n    let color = '#';\n    for (let i = 0; i < 3; i++) {\n      color += letters[Math.floor(Math.random() * letters.length)];\n    }\n    return color;\n  }\n\n  // Override the\n  applyPanelTimeOverrides() {\n    super.applyPanelTimeOverrides();\n\n    if (this.panel.expandFromQueryS && this.panel.expandFromQueryS > 0) {\n      const from = this.range.from.subtract(this.panel.expandFromQueryS, 's');\n      this.range.from = from;\n      this.range.raw.from = from;\n    }\n  }\n\n  // This should only be called from the snapshot callback\n  onSnapshotLoad(dataList: LegacyResponseData[]) {\n    this.onDataFramesReceived(getProcessedDataFrames(dataList));\n  }\n\n  // Directly support DataFrame\n  onDataFramesReceived(frames: DataFrame[]) {\n    $(this.canvas).css('cursor', 'pointer');\n\n    const data: DistinctPoints[] = [];\n    frames.forEach(frame => {\n      const time = getTimeField(frame).timeField;\n      if (time) {\n        frame.fields.forEach(field => {\n          if (field !== time) {\n            const res = new DistinctPoints(this.fieldNamer(field, frame, frames));\n            for (let i = 0; i < time.values.length; i++) {\n              res.add(time.values.get(i), this.formatValue(field.values.get(i)));\n            }\n            res.finish(this);\n            data.push(res);\n          }\n        });\n      }\n    });\n    this.data = data;\n    this.updateLegendMetrics();\n\n    // Annotations Query\n    this.annotationsSrv\n      .getAnnotations({\n        dashboard: this.dashboard,\n        panel: this.panel, // {id: 4}, //\n        range: this.range,\n      })\n      .then(\n        result => {\n          this.loading = false;\n          if (result.annotations && result.annotations.length > 0) {\n            this.annotations = result.annotations;\n          } else {\n            this.annotations = null;\n          }\n          this.onRender();\n        },\n        () => {\n          this.loading = false;\n          this.annotations = null;\n          this.onRender();\n          console.log('ERRR', this);\n        }\n      );\n  }\n\n  updateLegendMetrics(notify?: boolean) {\n    if (!this.data || !this.panel.showLegend || this.panel.showLegendNames || this.data.length <= 1) {\n      this.legend = this.data;\n    } else {\n      this.legend = [DistinctPoints.combineLegend(this.data, this)];\n    }\n\n    if (notify) {\n      this.onConfigChanged();\n    }\n  }\n\n  removeColorMap(map) {\n    const index = _.indexOf(this.panel.colorMaps, map);\n    this.panel.colorMaps.splice(index, 1);\n    this.updateColorInfo();\n  }\n\n  updateColorInfo() {\n    const cm = {};\n    for (let i = 0; i < this.panel.colorMaps.length; i++) {\n      const m = this.panel.colorMaps[i];\n      if (m.text) {\n        cm[m.text] = m.color;\n      }\n    }\n    this._colorsPaleteCash = {};\n    this._colorsPaleteCash.length = 0;\n    this.colorMap = cm;\n    this.render();\n  }\n\n  addColorMap(what) {\n    if (what === 'curent') {\n      _.forEach(this.data, metric => {\n        if (metric.legendInfo) {\n          _.forEach(metric.legendInfo, info => {\n            if (!_.has(this.colorMap, info.val)) {\n              const v = { text: info.val, color: this.getColor(info.val) };\n              this.panel.colorMaps.push(v);\n              this.colorMap[info.val] = v;\n            }\n          });\n        }\n      });\n    } else {\n      this.panel.colorMaps.push({ text: '???', color: this.randomColor() });\n    }\n    this.updateColorInfo();\n  }\n\n  removeValueMap(map) {\n    const index = _.indexOf(this.panel.valueMaps, map);\n    this.panel.valueMaps.splice(index, 1);\n    this.render();\n  }\n\n  addValueMap() {\n    this.panel.valueMaps.push({ value: '', op: '=', text: '' });\n  }\n\n  removeRangeMap(rangeMap) {\n    const index = _.indexOf(this.panel.rangeMaps, rangeMap);\n    this.panel.rangeMaps.splice(index, 1);\n    this.render();\n  }\n\n  addRangeMap() {\n    this.panel.rangeMaps.push({ from: '', to: '', text: '' });\n  }\n\n  onConfigChanged(update = false) {\n    this.isTimeline = this.panel.display === 'timeline';\n    this.isStacked = this.panel.display === 'stacked';\n\n    this.formatter = null;\n    if (this.panel.units && 'none' !== this.panel.units) {\n      this.formatter = kbn.valueFormats[this.panel.units];\n    }\n\n    if (update) {\n      this.refresh();\n    } else {\n      this.render();\n    }\n  }\n\n  formatDuration(duration) {\n    if (!this.panel.useTimePrecision) {\n      return duration.humanize();\n    }\n\n    const dir: any = {};\n    let hasValue = false;\n    let limit = false;\n\n    for (const o of this.panel.timeOptions) {\n      dir[o.value] = parseInt(duration.as(o.value), 10);\n      hasValue = dir[o.value] || hasValue;\n      duration.subtract(moment.duration(dir[o.value], o.value));\n      limit = this.panel.timePrecision.value === o.value || limit;\n\n      // always show a value in case it is less than the configured\n      // precision\n      if (limit && hasValue) {\n        break;\n      }\n    }\n\n    const rs = Object.keys(dir).reduce((carry, key) => {\n      const value = dir[key];\n      if (!value) {\n        return carry;\n      }\n      key = value < 2 ? key.replace(/s$/, '') : key;\n      return `${carry} ${value} ${key},`;\n    }, '');\n\n    return rs.substr(0, rs.length - 1);\n  }\n\n  getLegendDisplay(info, metric) {\n    let disp = info.val;\n    if (this.panel.showLegendPercent || this.panel.showLegendCounts || this.panel.showLegendTime) {\n      disp += ' (';\n      let hassomething = false;\n      if (this.panel.showLegendTime) {\n        disp += this.formatDuration(moment.duration(info.ms));\n        hassomething = true;\n      }\n\n      if (this.panel.showLegendPercent) {\n        if (hassomething) {\n          disp += ', ';\n        }\n\n        let dec = this.panel.legendPercentDecimals;\n        if (_.isNil(dec)) {\n          if (info.per > 0.98 && metric.changes.length > 1) {\n            dec = 2;\n          } else if (info.per < 0.02) {\n            dec = 2;\n          } else {\n            dec = 0;\n          }\n        }\n        disp += kbn.valueFormats.percentunit(info.per, dec);\n        hassomething = true;\n      }\n\n      if (this.panel.showLegendCounts) {\n        if (hassomething) {\n          disp += ', ';\n        }\n        disp += info.count + 'x';\n      }\n      disp += ')';\n    }\n    return disp;\n  }\n\n  //------------------\n  // Mouse Events\n  //------------------\n\n  showTooltip(evt, point, isExternal) {\n    let from = point.start;\n    let to = point.start + point.ms;\n    let time = point.ms;\n    let val = point.val;\n\n    if (this.mouse.down != null) {\n      from = Math.min(this.mouse.down.ts, this.mouse.position.ts);\n      to = Math.max(this.mouse.down.ts, this.mouse.position.ts);\n      time = to - from;\n      val = 'Zoom To:';\n    }\n    let timeformat = '';\n    if (this.panel.use12HourClock) {\n      timeformat = 'YYYY-MM-DD h:mm:ss a';\n    }\n    let body = '<div class=\"graph-tooltip-time\">' + val + '</div>';\n\n    body += '<center>';\n    body += this.dashboard.formatDate(moment(from), timeformat) + '<br/>';\n    body += 'to<br/>';\n    body += this.dashboard.formatDate(moment(to), timeformat) + '<br/><br/>';\n    body += this.formatDuration(moment.duration(time)) + '<br/>';\n    body += '</center>';\n\n    let pageX = 0;\n    let pageY = 0;\n    if (isExternal) {\n      const rect = this.canvas.getBoundingClientRect();\n      pageY = rect.top + evt.pos.panelRelY * rect.height;\n      if (pageY < 0 || pageY > $(window).innerHeight()) {\n        // Skip Hidden tooltip\n        this.$tooltip.detach();\n        return;\n      }\n      pageY += $(window).scrollTop();\n\n      const elapsed = this.range.to - this.range.from;\n      const pX = (evt.pos.x - this.range.from) / elapsed;\n      pageX = rect.left + pX * rect.width;\n    } else {\n      pageX = evt.evt.pageX;\n      pageY = evt.evt.pageY;\n    }\n\n    this.$tooltip.html(body).place_tt(pageX + 20, pageY + 5);\n  }\n\n  getCorrectTime(ts: number) {\n    const from = moment(this.range.from).valueOf();\n    return ts < from ? from : ts;\n  }\n\n  onGraphHover(evt, showTT, isExternal) {\n    this.externalPT = false;\n    if (this.data && this.data.length) {\n      let hover: any = null;\n      let j = Math.floor(this.mouse.position.y / this.panel.rowHeight);\n      if (j < 0) {\n        j = 0;\n      }\n      if (j >= this.data.length) {\n        j = this.data.length - 1;\n      }\n\n      if (this.isTimeline) {\n        hover = this.data[j].changes[0];\n        for (let i = 0; i < this.data[j].changes.length; i++) {\n          if (this.data[j].changes[i].start > this.mouse.position.ts) {\n            break;\n          }\n          hover = this.data[j].changes[i];\n        }\n\n        hover.start = this.getCorrectTime(hover.start);\n\n        this.hoverPoint = hover;\n\n        if (this.annotations && !isExternal && this._renderDimensions) {\n          if (evt.pos.y > this._renderDimensions.rowsHeight - 5) {\n            const min = _.isUndefined(this.range.from) ? null : this.range.from.valueOf();\n            const max = _.isUndefined(this.range.to) ? null : this.range.to.valueOf();\n            const width = this._renderDimensions.width;\n\n            const anno = _.find(this.annotations, a => {\n              if (a.isRegion) {\n                return evt.pos.x > a.time && evt.pos.x < a.timeEnd;\n              }\n              const annoX = ((a.time - min) / (max - min)) * width;\n              const mouseX = evt.evt.offsetX;\n              return annoX > mouseX - 5 && annoX < mouseX + 5;\n            });\n            if (anno) {\n              console.log('TODO, hover <annotation-tooltip>', anno);\n              // See: https://github.com/grafana/grafana/blob/master/public/app/plugins/panel/graph/jquery.flot.events.js#L10\n              this.$tooltip.html(anno.text).place_tt(evt.evt.pageX + 20, evt.evt.pageY + 5);\n              return;\n            }\n          }\n        }\n\n        if (showTT) {\n          this.externalPT = isExternal;\n          this.showTooltip(evt, hover, isExternal);\n        }\n        this.onRender(); // refresh the view\n      } else if (!isExternal) {\n        if (this.isStacked) {\n          hover = this.data[j].legendInfo[0];\n          // for (let i = 0; i < this.data[j].legendInfo.length; i++) {\n          //   if (this.data[j].legendInfo[i].x > this.mouse.position.x) {\n          //     break;\n          //   }\n          //   hover = this.data[j].legendInfo[i];\n          // }\n          this.hoverPoint = hover;\n          this.onRender(); // refresh the view\n\n          if (showTT) {\n            this.externalPT = isExternal;\n            this.showLegandTooltip(evt.evt, hover);\n          }\n        }\n      }\n    } else {\n      this.$tooltip.detach(); // make sure it is hidden\n    }\n  }\n\n  onMouseClicked(where, event) {\n    if (event.metaKey === true || event.ctrlKey === true) {\n      console.log('TODO? Create Annotation?', where, event);\n      return;\n    }\n\n    const pt = this.hoverPoint;\n    if (pt && pt.start) {\n      const range = { from: moment.utc(pt.start), to: moment.utc(pt.start + pt.ms) };\n      this.timeSrv.setTime(range);\n      this.clear();\n    }\n  }\n\n  onMouseSelectedRange(range, event) {\n    if (event.metaKey === true || event.ctrlKey === true) {\n      console.log('TODO? Create range annotation?', range, event);\n      return;\n    }\n    this.timeSrv.setTime(range);\n    this.clear();\n  }\n\n  clear() {\n    this.mouse.position = null;\n    this.mouse.down = null;\n    this.hoverPoint = null;\n    $(this.canvas).css('cursor', 'wait');\n    appEvents.emit('graph-hover-clear');\n    this.render();\n  }\n\n  _updateRenderDimensions() {\n    this._renderDimensions = {};\n\n    const rect = (this._renderDimensions.rect = this.wrap.getBoundingClientRect());\n    const rows = (this._renderDimensions.rows = this.data.length);\n    const rowHeight = (this._renderDimensions.rowHeight = this.panel.rowHeight);\n    const rowsHeight = (this._renderDimensions.rowsHeight = rowHeight * rows);\n    const timeHeight = this.panel.showTimeAxis ? 14 + this.panel.textSizeTime : 0;\n    const height = (this._renderDimensions.height = rowsHeight + timeHeight);\n    const width = (this._renderDimensions.width = rect.width);\n    this._renderDimensions.height = height;\n\n    // First render?\n    if (!this.range) {\n      this.range = {\n        to: 2000,\n        from: 1000,\n      };\n    }\n\n    let top = 0;\n    const elapsed = this.range.to - this.range.from;\n\n    this._renderDimensions.matrix = [];\n    _.forEach(this.data, metric => {\n      const positions: any[] = [];\n\n      if (this.isTimeline) {\n        let point = metric.changes[0];\n        for (let i = 0; i < metric.changes.length; i++) {\n          point = metric.changes[i];\n          if (point.start <= this.range.to) {\n            const xt = Math.max(point.start - this.range.from, 0);\n            const x = (xt / elapsed) * width;\n            positions.push(x);\n          }\n        }\n      }\n\n      if (this.isStacked) {\n        let point: LegendValue;\n        let start = this.range.from;\n        for (let i = 0; i < metric.legendInfo.length; i++) {\n          point = metric.legendInfo[i];\n          const xt = Math.max(start - this.range.from, 0);\n          const x = (xt / elapsed) * width;\n          positions.push(x);\n          start += point.ms;\n        }\n      }\n\n      this._renderDimensions.matrix.push({\n        y: top,\n        positions: positions,\n      });\n\n      top += rowHeight;\n    });\n  }\n\n  _updateSelectionMatrix() {\n    const selectionPredicates = {\n      all: () => {\n        return true;\n      },\n      crosshairHover: function(i, j) {\n        if (j + 1 === this.data[i].changes.length) {\n          return this.data[i].changes[j].start <= this.mouse.position.ts;\n        }\n        return (\n          this.data[i].changes[j].start <= this.mouse.position.ts &&\n          this.mouse.position.ts < this.data[i].changes[j + 1].start\n        );\n      },\n      mouseX: function(i, j) {\n        const row = this._renderDimensions.matrix[i];\n        if (j + 1 === row.positions.length) {\n          return row.positions[j] <= this.mouse.position.x;\n        }\n        return row.positions[j] <= this.mouse.position.x && this.mouse.position.x < row.positions[j + 1];\n      },\n      metric: function(i) {\n        return this.data[i] === this._selectedMetric;\n      },\n      legendItem: function(i, j) {\n        if (this.data[i] !== this._selectedMetric) {\n          return false;\n        }\n        return this._selectedLegendItem.val === this._getVal(i, j);\n      },\n    };\n\n    function getPredicate() {\n      if (this._selectedLegendItem !== undefined) {\n        return 'legendItem';\n      }\n      if (this._selectedMetric !== undefined) {\n        return 'metric';\n      }\n      if (this.mouse.down !== null) {\n        return 'all';\n      }\n      if (this.panel.highlightOnMouseover && this.mouse.position != null) {\n        if (this.isTimeline) {\n          return 'crosshairHover';\n        }\n        if (this.isStacked) {\n          return 'mouseX';\n        }\n      }\n      return 'all';\n    }\n\n    const pn = getPredicate.bind(this)();\n    const predicate = selectionPredicates[pn].bind(this);\n    this._selectionMatrix = [];\n    for (let i = 0; i < this._renderDimensions.matrix.length; i++) {\n      const rs: any[] = [];\n      const r = this._renderDimensions.matrix[i];\n      for (let j = 0; j < r.positions.length; j++) {\n        rs.push(predicate(i, j));\n      }\n      this._selectionMatrix.push(rs);\n    }\n  }\n\n  _updateCanvasSize() {\n    this.canvas.width = this._renderDimensions.width * this._devicePixelRatio;\n    this.canvas.height = this._renderDimensions.height * this._devicePixelRatio;\n\n    $(this.canvas).css('width', this._renderDimensions.width + 'px');\n    $(this.canvas).css('height', this._renderDimensions.height + 'px');\n\n    this.context.scale(this._devicePixelRatio, this._devicePixelRatio);\n  }\n\n  _getVal(metricIndex, rectIndex) {\n    let point: any;\n    if (this.isTimeline) {\n      point = this.data[metricIndex].changes[rectIndex];\n    }\n    if (this.isStacked) {\n      point = this.data[metricIndex].legendInfo[rectIndex];\n    }\n    return point.val;\n  }\n\n  _renderRects() {\n    const matrix = this._renderDimensions.matrix;\n    const ctx = this.context;\n\n    // Clear the background\n    ctx.fillStyle = this.panel.backgroundColor;\n    ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\n    _.forEach(this.data, (metric, i) => {\n      const rowObj = matrix[i];\n      for (let j = 0; j < rowObj.positions.length; j++) {\n        const currentX = rowObj.positions[j];\n        let nextX = this._renderDimensions.width;\n        if (j + 1 !== rowObj.positions.length) {\n          nextX = rowObj.positions[j + 1];\n        }\n        ctx.fillStyle = this.getColor(this._getVal(i, j));\n        const globalAlphaTemp = ctx.globalAlpha;\n        if (!this._selectionMatrix[i][j]) {\n          ctx.globalAlpha = 0.3;\n        }\n        ctx.fillRect(currentX, matrix[i].y, nextX - currentX, this._renderDimensions.rowHeight);\n        ctx.globalAlpha = globalAlphaTemp;\n      }\n\n      if (i > 0) {\n        const top = matrix[i].y;\n        ctx.strokeStyle = this.panel.lineColor;\n        ctx.beginPath();\n        ctx.moveTo(0, top);\n        ctx.lineTo(this._renderDimensions.width, top);\n        ctx.stroke();\n      }\n    });\n  }\n\n  _renderLabels() {\n    const ctx = this.context;\n    ctx.lineWidth = 1;\n    ctx.textBaseline = 'middle';\n    ctx.font = this.panel.textSize + 'px \"Open Sans\", Helvetica, Arial, sans-serif';\n\n    const offset = 2;\n    const rowHeight = this._renderDimensions.rowHeight;\n    _.forEach(this.data, (metric, i) => {\n      const { y, positions } = this._renderDimensions.matrix[i];\n\n      const centerY = y + rowHeight / 2;\n      // let labelPositionMetricName = y + rectHeight - this.panel.textSize / 2;\n      // let labelPositionLastValue = y + rectHeight - this.panel.textSize / 2;\n      // let labelPositionValue = y + this.panel.textSize / 2;\n      const labelPositionMetricName = centerY;\n      const labelPositionLastValue = centerY;\n      const labelPositionValue = centerY;\n\n      let minTextSpot = 0;\n      let maxTextSpot = this._renderDimensions.width;\n      if (this.panel.writeMetricNames) {\n        ctx.fillStyle = this.panel.metricNameColor;\n        ctx.textAlign = 'left';\n        ctx.fillText(metric.name, offset, labelPositionMetricName);\n        minTextSpot = offset + ctx.measureText(metric.name).width + 2;\n      }\n\n      let hoverTextStart = -1;\n      let hoverTextEnd = -1;\n\n      if (this.mouse.position) {\n        for (let j = 0; j < positions.length; j++) {\n          if (positions[j] <= this.mouse.position.x) {\n            if (j >= positions.length - 1 || positions[j + 1] >= this.mouse.position.x) {\n              let val = this._getVal(i, j);\n              ctx.fillStyle = this.panel.valueTextColor;\n              ctx.textAlign = 'left';\n              hoverTextStart = positions[j] + offset;\n              if (hoverTextStart < minTextSpot) {\n                hoverTextStart = minTextSpot + 2;\n                val = ': ' + val;\n              }\n\n              ctx.fillText(val, hoverTextStart, labelPositionValue);\n              const txtinfo = ctx.measureText(val);\n              hoverTextEnd = hoverTextStart + txtinfo.width + 4;\n              break;\n            }\n          }\n        }\n      }\n\n      if (this.panel.writeLastValue) {\n        const val = this._getVal(i, positions.length - 1);\n        ctx.fillStyle = this.panel.valueTextColor;\n        ctx.textAlign = 'right';\n        const txtinfo = ctx.measureText(val);\n        const xval = this._renderDimensions.width - offset - txtinfo.width;\n        if (xval > hoverTextEnd) {\n          ctx.fillText(val, this._renderDimensions.width - offset, labelPositionLastValue);\n          maxTextSpot = this._renderDimensions.width - ctx.measureText(val).width - 10;\n        }\n      }\n\n      if (this.panel.writeAllValues) {\n        ctx.fillStyle = this.panel.valueTextColor;\n        ctx.textAlign = 'left';\n        for (let j = 0; j < positions.length; j++) {\n          const val = this._getVal(i, j);\n          let nextX = this._renderDimensions.width;\n          if (j + 1 !== positions.length) {\n            nextX = positions[j + 1];\n          }\n\n          const x = positions[j];\n          if (x > minTextSpot) {\n            const width = nextX - x;\n            if (maxTextSpot > x + width) {\n              // This clips the text within the given bounds\n              ctx.save();\n              ctx.rect(x, y, width, rowHeight);\n              ctx.clip();\n\n              ctx.fillText(val, x + offset, labelPositionValue);\n              ctx.restore();\n            }\n          }\n        }\n      }\n    });\n  }\n\n  _renderSelection() {\n    if (this.mouse.down === null) {\n      return;\n    }\n    if (this.mouse.position === null) {\n      return;\n    }\n    if (!this.isTimeline) {\n      return;\n    }\n\n    const ctx = this.context;\n    const height = this._renderDimensions.height;\n\n    const xmin = Math.min(this.mouse.position.x, this.mouse.down.x);\n    const xmax = Math.max(this.mouse.position.x, this.mouse.down.x);\n\n    ctx.fillStyle = 'rgba(110, 110, 110, 0.5)';\n    ctx.strokeStyle = 'rgba(110, 110, 110, 0.5)';\n    ctx.beginPath();\n    ctx.fillRect(xmin, 0, xmax - xmin, height);\n    ctx.strokeRect(xmin, 0, xmax - xmin, height);\n  }\n\n  _renderTimeAxis() {\n    if (!this.panel.showTimeAxis) {\n      return;\n    }\n\n    const ctx = this.context;\n    // const rows = this.data.length;\n    // const rowHeight = this.panel.rowHeight;\n    // const height = this._renderDimensions.height;\n    const width = this._renderDimensions.width;\n    const top = this._renderDimensions.rowsHeight;\n\n    const headerColumnIndent = 0; // header inset (zero for now)\n\n    ctx.font = this.panel.textSizeTime + 'px \"Open Sans\", Helvetica, Arial, sans-serif';\n    ctx.fillStyle = this.panel.timeTextColor;\n    ctx.textAlign = 'left';\n    ctx.strokeStyle = this.panel.timeTextColor;\n    ctx.textBaseline = 'top';\n    ctx.setLineDash([7, 5]); // dashes are 5px and spaces are 3px\n    ctx.lineDashOffset = 0;\n\n    const min = _.isUndefined(this.range.from) ? null : this.range.from.valueOf();\n    const max = _.isUndefined(this.range.to) ? null : this.range.to.valueOf();\n    const minPxInterval = ctx.measureText('12/33 24:59').width * 2;\n    const estNumTicks = width / minPxInterval;\n    const estTimeInterval = (max - min) / estNumTicks;\n    const timeResolution = this.getTimeResolution(estTimeInterval);\n    const pixelStep = (timeResolution / (max - min)) * width;\n    let nextPointInTime = this.roundDate(min, timeResolution) + timeResolution;\n    let xPos = headerColumnIndent + ((nextPointInTime - min) / (max - min)) * width;\n\n    const timeFormat = this.time_format(max - min, timeResolution / 1000);\n    let displayOffset = 0;\n    if (this.dashboard.getTimezone() === 'utc') {\n      displayOffset = new Date().getTimezoneOffset() * 60000;\n    }\n\n    while (nextPointInTime < max) {\n      // draw ticks\n      ctx.beginPath();\n      ctx.moveTo(xPos, top + 5);\n      ctx.lineTo(xPos, 0);\n      ctx.lineWidth = 1;\n      ctx.stroke();\n\n      // draw time label\n      const date = new Date(nextPointInTime + displayOffset);\n      const dateStr = this.formatDate(date, timeFormat);\n      const xOffset = ctx.measureText(dateStr).width / 2;\n      ctx.fillText(dateStr, xPos - xOffset, top + 10);\n\n      nextPointInTime += timeResolution;\n      xPos += pixelStep;\n    }\n  }\n\n  _renderCrosshair() {\n    if (this.mouse.down != null) {\n      return;\n    }\n    if (this.mouse.position === null) {\n      return;\n    }\n    if (!this.isTimeline) {\n      return;\n    }\n\n    const ctx = this.context;\n    const rows = this.data.length;\n    //let rowHeight = this.panel.rowHeight;\n    const height = this._renderDimensions.height;\n\n    ctx.beginPath();\n    ctx.moveTo(this.mouse.position.x, 0);\n    ctx.lineTo(this.mouse.position.x, height);\n    ctx.strokeStyle = this.panel.crosshairColor;\n    ctx.setLineDash([]);\n    ctx.lineWidth = 1;\n    ctx.stroke();\n\n    // Draw a Circle around the point if showing a tooltip\n    if (this.externalPT && rows > 1) {\n      ctx.beginPath();\n      ctx.arc(this.mouse.position.x, this.mouse.position.y, 3, 0, 2 * Math.PI, false);\n      ctx.fillStyle = this.panel.crosshairColor;\n      ctx.fill();\n      ctx.lineWidth = 1;\n    }\n  }\n\n  _renderAnnotations() {\n    if (!this.panel.showTimeAxis) {\n      return;\n    }\n    if (!this.annotations) {\n      return;\n    }\n\n    const ctx = this.context;\n    //const rows = this.data.length;\n    const rowHeight = this.panel.rowHeight;\n    //const height = this._renderDimensions.height;\n    const width = this._renderDimensions.width;\n    const top = this._renderDimensions.rowsHeight;\n\n    const headerColumnIndent = 0; // header inset (zero for now)\n    ctx.font = this.panel.textSizeTime + 'px \"Open Sans\", Helvetica, Arial, sans-serif';\n    ctx.fillStyle = '#7FE9FF';\n    ctx.textAlign = 'left';\n    ctx.strokeStyle = '#7FE9FF';\n\n    ctx.textBaseline = 'top';\n    ctx.setLineDash([3, 3]);\n    ctx.lineDashOffset = 0;\n    ctx.lineWidth = 2;\n\n    const min = _.isUndefined(this.range.from) ? null : this.range.from.valueOf();\n    const max = _.isUndefined(this.range.to) ? null : this.range.to.valueOf();\n    //let xPos = headerColumnIndent;\n\n    _.forEach(this.annotations, anno => {\n      ctx.setLineDash([3, 3]);\n\n      let isAlert = false;\n      if (anno.source.iconColor) {\n        ctx.fillStyle = anno.source.iconColor;\n        ctx.strokeStyle = anno.source.iconColor;\n      } else if (anno.annotation === undefined) {\n        // grafana annotation\n        ctx.fillStyle = '#7FE9FF';\n        ctx.strokeStyle = '#7FE9FF';\n      } else {\n        isAlert = true;\n        ctx.fillStyle = '#EA0F3B'; //red\n        ctx.strokeStyle = '#EA0F3B';\n      }\n\n      this._drawVertical(ctx, anno.time, min, max, headerColumnIndent, top, width, isAlert);\n\n      //do the TO rangeMap\n      if (anno.isRegion) {\n        this._drawVertical(ctx, anno.timeEnd, min, max, headerColumnIndent, top, width, isAlert);\n\n        //draw horizontal line at bottom\n        const xPosStart = headerColumnIndent + ((anno.time - min) / (max - min)) * width;\n        const xPosEnd = headerColumnIndent + ((anno.timeEnd - min) / (max - min)) * width;\n\n        // draw ticks\n        ctx.beginPath();\n        ctx.moveTo(xPosStart, top + 5);\n        ctx.lineTo(xPosEnd, top + 5);\n\n        ctx.lineWidth = 4;\n        ctx.setLineDash([]);\n        ctx.stroke();\n        //end horizontal\n        //do transparency\n        if (isAlert === false) {\n          ctx.save();\n          ctx.fillStyle = '#7FE9FF';\n          ctx.globalAlpha = 0.2;\n          ctx.fillRect(xPosStart, 0, xPosEnd - xPosStart, rowHeight);\n          ctx.stroke();\n          ctx.restore();\n        }\n      }\n    });\n  }\n\n  _drawVertical(ctx, timeVal, min, max, headerColumnIndent, top, width, isAlert) {\n    const xPos = headerColumnIndent + ((timeVal - min) / (max - min)) * width;\n\n    // draw ticks\n    ctx.lineWidth = 1;\n    ctx.beginPath();\n    ctx.moveTo(xPos, top + 5);\n    ctx.lineTo(xPos, 0);\n    ctx.stroke();\n\n    // draw triangle\n    ctx.moveTo(xPos + 0, top);\n    ctx.lineTo(xPos - 5, top + 7);\n    ctx.lineTo(xPos + 5, top + 7);\n    ctx.fill();\n\n    // draw alert label\n    if (isAlert === true) {\n      const dateStr = '\\u25B2';\n      const xOffset = ctx.measureText(dateStr).width / 2;\n      ctx.fillText(dateStr, xPos - xOffset, top + 10);\n    }\n  }\n}\n\n/**\n * All panels will be passed tables that have our best guess at colum type set\n *\n * This is also used by PanelChrome for snapshot support\n */\nexport function getProcessedDataFrames(results?: DataQueryResponseData[]): DataFrame[] {\n  if (!results || !isArray(results)) {\n    return [];\n  }\n\n  const dataFrames: DataFrame[] = [];\n\n  for (const result of results) {\n    const dataFrame = guessFieldTypes(toDataFrame(result));\n\n    // clear out any cached calcs\n    for (const field of dataFrame.fields) {\n      const f = field as any;\n      f.calcs = undefined;\n      f.state = undefined;\n    }\n\n    dataFrames.push(dataFrame);\n  }\n\n  return dataFrames;\n}\n\nexport { DiscretePanelCtrl as PanelCtrl };\n"],"sourceRoot":""}