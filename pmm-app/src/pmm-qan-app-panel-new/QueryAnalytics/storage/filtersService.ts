const result = {
  labels: {
    '': {
      name: [{ main_metric_percent: 1, main_metric_per_sec: 0.003997429 }],
    },
    az: {
      name: [
        {
          value: 'rdu2',
          main_metric_percent: 0.50750667,
          main_metric_per_sec: 8.668584,
        },
        {
          value: 'rdu3',
          main_metric_percent: 0.45282704,
          main_metric_per_sec: 7.734616,
        },
        {
          value: 'sfo2',
          main_metric_percent: 0.019451141,
          main_metric_per_sec: 0.33223966,
        },
        {
          value: 'rdu1',
          main_metric_percent: 0.017040236,
          main_metric_per_sec: 0.29105964,
        },
        {
          value: 'mex1',
          main_metric_percent: 0.0029408638,
          main_metric_per_sec: 0.050232098,
        },
        { main_metric_percent: 0.00023403151, main_metric_per_sec: 0.003997429 },
      ],
    },
    city: {
      name: [
        {
          value: 'Raleigh',
          main_metric_percent: 0.9776028,
          main_metric_per_sec: 16.69426,
        },
        {
          value: 'San_Francisco',
          main_metric_percent: 0.019455694,
          main_metric_per_sec: 0.33223966,
        },
        {
          value: 'Mexico_City',
          main_metric_percent: 0.0029415523,
          main_metric_per_sec: 0.050232098,
        },
      ],
    },
    client_host: {
      name: [
        {
          value: 'localhost',
          main_metric_percent: 0.5259988,
          main_metric_per_sec: 8.984443,
        },
        { main_metric_percent: 0.47400114, main_metric_per_sec: 8.096285 },
      ],
    },
    cluster: {
      name: [
        {
          value: 'PXCCluster1',
          main_metric_percent: 0.97737396,
          main_metric_per_sec: 16.69426,
        },
        {
          value: 'PostgreSQLCluster1',
          main_metric_percent: 0.019451141,
          main_metric_per_sec: 0.33223966,
        },
        {
          value: 'MySQLCluster1',
          main_metric_percent: 0.0029408638,
          main_metric_per_sec: 0.050232098,
        },
        { main_metric_percent: 0.00023403151, main_metric_per_sec: 0.003997429 },
      ],
    },
    container_id: {
      name: [{ main_metric_percent: 1, main_metric_per_sec: 17.080729 }],
    },
    container_name: {
      name: [{ main_metric_percent: 1, main_metric_per_sec: 17.080729 }],
    },
    database: {
      name: [
        { main_metric_percent: 0.98031485, main_metric_per_sec: 16.744492 },
        {
          value: 'sbtest',
          main_metric_percent: 0.019274136,
          main_metric_per_sec: 0.32921627,
        },
        {
          value: 'postgres',
          main_metric_percent: 0.0003801732,
          main_metric_per_sec: 0.0064936355,
        },
        {
          value: 'pmm-managed',
          main_metric_percent: 0.000029526986,
          main_metric_per_sec: 0.00050434243,
        },
        {
          value: 'pmm_metrics',
          main_metric_percent: 0.0000013367398,
          main_metric_per_sec: 0.00002283249,
        },
      ],
    },
    environment: {
      name: [
        {
          value: 'Dev',
          main_metric_percent: 0.97737396,
          main_metric_per_sec: 16.69426,
        },
        {
          value: 'Prod',
          main_metric_percent: 0.022392005,
          main_metric_per_sec: 0.38247174,
        },
        { main_metric_percent: 0.00023403151, main_metric_per_sec: 0.003997429 },
      ],
    },
    machine_id: {
      name: [
        {
          value: '/machine_id/f9de291ab1aceb1b9dfb858d5c34fc50\n',
          main_metric_percent: 0.50750667,
          main_metric_per_sec: 8.668584,
        },
        {
          value: '/machine_id/0e89aeb71f5c94a02e501e3a5c34fc50\n',
          main_metric_percent: 0.45282704,
          main_metric_per_sec: 7.734616,
        },
        {
          value: '/machine_id/4a72d0375acdafdc2d712a495d2e96a4\n',
          main_metric_percent: 0.019451141,
          main_metric_per_sec: 0.33223966,
        },
        {
          value: '/machine_id/ad98511cb53a168686dcd8895c34fc53\n',
          main_metric_percent: 0.017040236,
          main_metric_per_sec: 0.29105964,
        },
        {
          value: '/machine_id/dbf7b5f349a2d7304e67deeb5c34fc6f\n',
          main_metric_percent: 0.0029408638,
          main_metric_per_sec: 0.050232098,
        },
        { main_metric_percent: 0.00023403151, main_metric_per_sec: 0.003997429 },
      ],
    },
    node_id: {
      name: [
        {
          value: '/node_id/b0c449c4-e788-4f81-9248-1326495052c9',
          main_metric_percent: 0.50750667,
          main_metric_per_sec: 8.668584,
        },
        {
          value: '/node_id/62d48cd3-de88-4290-96c1-97a9b4a0f648',
          main_metric_percent: 0.45282704,
          main_metric_per_sec: 7.734616,
        },
        {
          value: '/node_id/6f1d007d-a4b2-4366-b980-215cd6cec3c6',
          main_metric_percent: 0.019451141,
          main_metric_per_sec: 0.33223966,
        },
        {
          value: '/node_id/203d558d-1e3e-4f57-b54e-1bb0c82fd90a',
          main_metric_percent: 0.017040236,
          main_metric_per_sec: 0.29105964,
        },
        {
          value: '/node_id/f43f105a-acce-489d-8615-b34962ec3956',
          main_metric_percent: 0.0029408638,
          main_metric_per_sec: 0.050232098,
        },
        {
          value: 'pmm-server',
          main_metric_percent: 0.00023403151,
          main_metric_per_sec: 0.003997429,
        },
      ],
    },
    node_model: {
      name: [{ main_metric_percent: 1, main_metric_per_sec: 17.080729 }],
    },
    node_name: {
      name: [
        {
          value: 'pxc57-2',
          main_metric_percent: 0.50750667,
          main_metric_per_sec: 8.668584,
        },
        {
          value: 'pxc57-3',
          main_metric_percent: 0.45282704,
          main_metric_per_sec: 7.734616,
        },
        {
          value: 'pg11',
          main_metric_percent: 0.019451141,
          main_metric_per_sec: 0.33223966,
        },
        {
          value: 'pxc57-1',
          main_metric_percent: 0.017040236,
          main_metric_per_sec: 0.29105964,
        },
        {
          value: 'ps8',
          main_metric_percent: 0.0029408638,
          main_metric_per_sec: 0.050232098,
        },
        {
          value: 'pmm-server',
          main_metric_percent: 0.00023403151,
          main_metric_per_sec: 0.003997429,
        },
      ],
    },
    node_type: {
      name: [
        {
          value: 'generic',
          main_metric_percent: 1,
          main_metric_per_sec: 17.080729,
        },
      ],
    },
    region: {
      name: [{ main_metric_percent: 1, main_metric_per_sec: 17.080729 }],
    },
    replication_set: {
      name: [
        {
          value: 'PXCReplSet1',
          main_metric_percent: 0.97737396,
          main_metric_per_sec: 16.69426,
        },
        {
          value: 'PostgreSQLReplSet1',
          main_metric_percent: 0.019451141,
          main_metric_per_sec: 0.33223966,
        },
        {
          value: 'MySQLReplSet1',
          main_metric_percent: 0.0029408638,
          main_metric_per_sec: 0.050232098,
        },
        { main_metric_percent: 0.00023403151, main_metric_per_sec: 0.003997429 },
      ],
    },
    schema: {
      name: [
        {
          value: 'innodb_2',
          main_metric_percent: 0.5063901,
          main_metric_per_sec: 8.649511,
        },
        {
          value: 'innodb_3',
          main_metric_percent: 0.45197195,
          main_metric_per_sec: 7.7200103,
        },
        { main_metric_percent: 0.022994658, main_metric_per_sec: 0.39276552 },
        {
          value: 'innodb',
          main_metric_percent: 0.010853752,
          main_metric_per_sec: 0.18538998,
        },
        {
          value: 'small',
          main_metric_percent: 0.006451513,
          main_metric_per_sec: 0.110196546,
        },
        {
          value: 'percona',
          main_metric_percent: 0.0013380199,
          main_metric_per_sec: 0.022854354,
        },
      ],
    },
    service_id: {
      name: [
        {
          value: '/service_id/dd171717-6ede-4ccf-95ee-e2423605c812',
          main_metric_percent: 0.50750667,
          main_metric_per_sec: 8.668584,
        },
        {
          value: '/service_id/24493995-d914-4f41-b530-bb6f2bb544d0',
          main_metric_percent: 0.45282704,
          main_metric_per_sec: 7.734616,
        },
        {
          value: '/service_id/638d5d11-0e91-445d-bc77-196770775f37',
          main_metric_percent: 0.019451141,
          main_metric_per_sec: 0.33223966,
        },
        {
          value: '/service_id/c983ec20-acb0-4305-aaff-68d05e8a79bb',
          main_metric_percent: 0.017040236,
          main_metric_per_sec: 0.29105964,
        },
        {
          value: '/service_id/c368d5fb-40c5-4174-a9d3-3897030c81f6',
          main_metric_percent: 0.0029408638,
          main_metric_per_sec: 0.050232098,
        },
        {
          value: '/service_id/8a38b0a9-e887-4171-b2e1-f595462dc765',
          main_metric_percent: 0.00023403151,
          main_metric_per_sec: 0.003997429,
        },
      ],
    },
    service_name: {
      name: [
        {
          value: 'pxc57-2-mysql',
          main_metric_percent: 0.50750667,
          main_metric_per_sec: 8.668584,
        },
        {
          value: 'pxc57-3-mysql',
          main_metric_percent: 0.45282704,
          main_metric_per_sec: 7.734616,
        },
        {
          value: 'pg11-postgresql',
          main_metric_percent: 0.019451141,
          main_metric_per_sec: 0.33223966,
        },
        {
          value: 'pxc57-1-mysql',
          main_metric_percent: 0.017040236,
          main_metric_per_sec: 0.29105964,
        },
        {
          value: 'ps8-mysql',
          main_metric_percent: 0.0029408638,
          main_metric_per_sec: 0.050232098,
        },
        {
          value: 'pmm-server-postgresql',
          main_metric_percent: 0.00023403151,
          main_metric_per_sec: 0.003997429,
        },
      ],
    },
    service_type: {
      name: [
        {
          value: 'mysql',
          main_metric_percent: 0.98031485,
          main_metric_per_sec: 16.744492,
        },
        {
          value: 'postgresql',
          main_metric_percent: 0.019685172,
          main_metric_per_sec: 0.33623707,
        },
      ],
    },
    username: {
      name: [
        {
          value: 'sbtest',
          main_metric_percent: 0.5418521,
          main_metric_per_sec: 9.255229,
        },
        { main_metric_percent: 0.45282704, main_metric_per_sec: 7.734616 },
        {
          value: 'pmm-metrics',
          main_metric_percent: 0.0023676783,
          main_metric_per_sec: 0.04044167,
        },
        {
          value: 'heartbeat',
          main_metric_percent: 0.0013380199,
          main_metric_per_sec: 0.022854354,
        },
        {
          value: 'sbtest1',
          main_metric_percent: 0.0010531795,
          main_metric_per_sec: 0.017989073,
        },
        {
          value: 'pmm-managed',
          main_metric_percent: 0.00023403151,
          main_metric_per_sec: 0.003997429,
        },
        {
          value: 'pmm_metrics',
          main_metric_percent: 0.00017700544,
          main_metric_per_sec: 0.0030233818,
        },
        {
          value: 'skip-grants user',
          main_metric_percent: 0.0001508983,
          main_metric_per_sec: 0.002577453,
        },
      ],
    },
  },
};

class FiltersService {
  private variables: any;
  constructor(variables) {
    this.variables = variables;
  }

  async getFilters() {
    return fetch('https://pmmdemo.percona.com/v0/qan/Filters/Get', {
      method: 'POST',
      body: JSON.stringify({
        main_metric_name: '',
        period_start_from: '2019-10-22T08:52:19+00:00',
        period_start_to: '2019-10-22T20:52:19+00:00',
      }),
    });
  }

  async getDetailedFilters() {
    return fetch('https://pmmdemo.percona.com/v0/qan/ObjectDetails/GetLabels', {
      method: 'POST',
      body: JSON.stringify({
        main_metric_name: '',
        period_start_from: '2019-10-22T08:52:19+00:00',
        period_start_to: '2019-10-22T20:52:19+00:00',
        labels: [],
        tables: [],
        group_by: '',
        filter_by: '',
      }),
    });
  }

  async getQueryDetailsFiltersList() {
    const selected = [];
    const notSelected = [];
    const result = await this.getDetailedFilters();
    const { labels } = await result.json();

    Object.keys(labels).forEach(label => {
      labels[label].name.forEach(metric => {
        const passedVariables = this.variables.filter(variable => variable.groupName === label).selectedValues;
        metric.selected = passedVariables.some(variable => variable === metric.value);
      });
    });
    return { selected, notSelected };
  }

  static getAutocompleteFiltersList(selectedVariables) {
    const selected: any[] = [];
    const options: any[] = [];
    // const result = await this.getFilters();
    const labels = result.labels;

    Object.keys(labels).forEach(label => {
      labels[label].name.forEach(metric => {
        const passedVariables = selectedVariables[label];

        metric.checked = passedVariables && passedVariables.some(variable => variable === metric.value);

        metric.key = `${label}:${metric.value}`;
        // @ts-ignore
        options.push(metric);
        if (metric.checked) {
          // @ts-ignore
          selected.push(`${label}:${metric.value}`);
        }
      });
    });

    return { selected, options };
  }

  static getQueryOverviewFiltersList(selectedVariables) {
    const labels = result.labels;
    Object.keys(labels).forEach(label => {
      labels[label].name.forEach(metric => {
        const passedVariables = selectedVariables[label];
        metric.checked = passedVariables && passedVariables.some(variable => variable === metric.value);
      });
    });
    return labels;
  }

  addFilter() {}

  removeFilter() {}

  navigateTo(url) {}
}

export default FiltersService;
