import { apiRequestQAN } from 'shared/components/helpers/api';
import { getLabelQueryParams } from 'pmm-qan/panel/QueryAnalytics.tools';

const markCheckedLabels = (labels, paramLabels) => {
  Object.keys(labels).forEach((label) => {
    labels[label].name.forEach((metric) => {
      const passedVariables = paramLabels[label];

      if (!passedVariables) {
        return;
      }

      const isChecked = passedVariables.some((variable) => {
        if (!metric.value) {
          // eslint-disable-next-line no-param-reassign
          metric.value = '';
        }

        return variable === metric.value;
      });

      // eslint-disable-next-line no-param-reassign
      metric.checked = isChecked;
    });
  });

  return labels;
};

export default {
  getQueryOverviewFiltersList: async (paramLabels, from, to, mainMetric) => {
    // const { labels } = await apiRequestQAN.post<any, any>('/Filters/Get', {
    //   labels: getLabelQueryParams(paramLabels),
    //   main_metric_name: mainMetric,
    //   period_start_from: from,
    //   period_start_to: to,
    // });
    //
    const {labels} = {"labels":{"az":{"name":[{"value":"mex1","main_metric_percent":0.44823942,"main_metric_per_sec":1.2475408},{"value":"rdu3","main_metric_percent":0.19586912,"main_metric_per_sec":0.5451433},{"value":"mex2","main_metric_percent":0.150675,"main_metric_per_sec":0.41935894},{"main_metric_percent":0.14546326,"main_metric_per_sec":0.4048536},{"value":"sfo2","main_metric_percent":0.04076706,"main_metric_per_sec":0.113462955},{"value":"us-east-1c","main_metric_percent":0.01161455,"main_metric_per_sec":0.032325637},{"value":"us-east-1b","main_metric_percent":0.006132274,"main_metric_per_sec":0.017067356},{"value":"sfo1","main_metric_percent":0.0012392468,"main_metric_per_sec":0.003449074},{"value":"sfo3"}]},"client_host":{"name":[{"main_metric_percent":0.78599155,"main_metric_per_sec":2.1875732},{"value":"localhost","main_metric_percent":0.21400836,"main_metric_per_sec":0.5956285}]},"cluster":{"name":[{"value":"MySQLCluster1","main_metric_percent":0.44823942,"main_metric_per_sec":1.2475408},{"value":"PXCCluster1","main_metric_percent":0.19586912,"main_metric_per_sec":0.5451433},{"value":"PXCCluster2","main_metric_percent":0.150675,"main_metric_per_sec":0.41935894},{"main_metric_percent":0.14546326,"main_metric_per_sec":0.4048536},{"value":"MongoDBCluster1","main_metric_percent":0.031846147,"main_metric_per_sec":0.08863426},{"value":"AWSCluster1","main_metric_percent":0.017746825,"main_metric_per_sec":0.049392994},{"value":"PostgreSQLCluster1","main_metric_percent":0.010160156,"main_metric_per_sec":0.028277766}]},"container_id":{"name":[{"main_metric_percent":1,"main_metric_per_sec":2.783202}]},"container_name":{"name":[{"main_metric_percent":1,"main_metric_per_sec":2.783202}]},"database":{"name":[{"main_metric_percent":0.95975685,"main_metric_per_sec":2.6711972},{"value":"config","main_metric_percent":0.030041337,"main_metric_per_sec":0.08361111},{"value":"postgres","main_metric_percent":0.010160153,"main_metric_per_sec":0.028277757},{"value":"local","main_metric_percent":0.000041585463,"main_metric_per_sec":0.00011574074},{"value":"pmm_metrics","main_metric_percent":3.0828387e-9,"main_metric_per_sec":8.580162e-9}]},"environment":{"name":[{"value":"Prod","main_metric_percent":0.6090746,"main_metric_per_sec":1.6951776},{"value":"Dev","main_metric_percent":0.21361594,"main_metric_per_sec":0.5945363},{"main_metric_percent":0.14546326,"main_metric_per_sec":0.4048536},{"value":"Staging","main_metric_percent":0.031846147,"main_metric_per_sec":0.08863426}]},"machine_id":{"name":[{"value":"/machine_id/dbf7b5f349a2d7304e67deeb5c34fc6f","main_metric_percent":0.43929195,"main_metric_per_sec":1.2226382},{"value":"/machine_id/0e89aeb71f5c94a02e501e3a5c34fc50","main_metric_percent":0.19586912,"main_metric_per_sec":0.5451433},{"main_metric_percent":0.13151973,"main_metric_per_sec":0.36604598},{"value":"/machine_id/9029b926372a8fcdbbe41a335e94dd21","main_metric_percent":0.104174264,"main_metric_per_sec":0.289938},{"value":"/machine_id/35c290bbe1819a2bb636d1bb5e94dd1f","main_metric_percent":0.046500746,"main_metric_per_sec":0.12942097},{"value":"/machine_id/bafd9429fd7c48c7b91fa5470d68d3f8","main_metric_percent":0.030049656,"main_metric_per_sec":0.08363426},{"value":"/machine_id/fdcc94b1d7ee4ffe8abc1f4fbf424b16","main_metric_percent":0.02050465,"main_metric_per_sec":0.05706858},{"value":"/machine_id/1ce3c7ada37fa270b7f8cdb35d2e9522","main_metric_percent":0.008947489,"main_metric_per_sec":0.024902668},{"value":"/machine_id/808c743db3784a5d978eb33235bf7095","main_metric_percent":0.006119073,"main_metric_per_sec":0.017030615},{"value":"/machine_id/4a72d0375acdafdc2d712a495d2e96a4","main_metric_percent":0.0051440895,"main_metric_per_sec":0.01431704},{"value":"/machine_id/314352a6eb5947a3950bb918e29874f2","main_metric_percent":0.005066611,"main_metric_per_sec":0.014101401},{"value":"/machine_id/8c2f20b33c4d134fa04e71745f296253","main_metric_percent":0.0050160657,"main_metric_per_sec":0.013960724},{"value":"/machine_id/ad0ceab823a34cd7ba0b6a002d415633","main_metric_percent":0.0012392468,"main_metric_per_sec":0.003449074},{"value":"/machine_id/5f0ea272731a4f43a644d090c3deef93","main_metric_percent":0.0005572452,"main_metric_per_sec":0.0015509259},{"value":"/machine_id/3175ac08e1da4e0f90e94e1512730f8f"},{"value":"/machine_id/5df2f440e9a04cd989e7fe1615ed63b9"},{"value":"/machine_id/be13bbdd91e5419499d0a35e82fb882f"}]},"node_id":{"name":[{"value":"/node_id/f43f105a-acce-489d-8615-b34962ec3956","main_metric_percent":0.43929195,"main_metric_per_sec":1.2226382},{"value":"/node_id/62d48cd3-de88-4290-96c1-97a9b4a0f648","main_metric_percent":0.19586912,"main_metric_per_sec":0.5451433},{"value":"/node_id/bf702186-16e3-4a4e-8096-2c162920b2ff","main_metric_percent":0.113772914,"main_metric_per_sec":0.31665298},{"value":"/node_id/b502525b-b882-4ead-92f5-1a18a7113969","main_metric_percent":0.104174264,"main_metric_per_sec":0.289938},{"value":"/node_id/fa53a232-e0f8-46db-a475-998e03dd1d46","main_metric_percent":0.046500746,"main_metric_per_sec":0.12942097},{"value":"/node_id/64f48c23-d71c-4338-9c08-8080df702259","main_metric_percent":0.030049656,"main_metric_per_sec":0.08363426},{"value":"/node_id/6160700c-d24f-4436-8dde-58947c0ae863","main_metric_percent":0.02050465,"main_metric_per_sec":0.05706858},{"value":"/node_id/643695f9-1edb-490b-b2db-fc37175f544c","main_metric_percent":0.01161455,"main_metric_per_sec":0.032325637},{"value":"/node_id/127577ad-63e0-4c4c-a246-44fd4d531313","main_metric_percent":0.008947489,"main_metric_per_sec":0.024902668},{"value":"/node_id/233fd128-c7c9-4700-b083-6f2e0dca4632","main_metric_percent":0.006132274,"main_metric_per_sec":0.017067356},{"value":"/node_id/b450e05a-f8a9-498c-9f48-8f08d4644445","main_metric_percent":0.006119073,"main_metric_per_sec":0.017030615},{"value":"/node_id/36940ffc-bb4a-42ff-a8f4-7f59a1bb2bca","main_metric_percent":0.0051440895,"main_metric_per_sec":0.01431704},{"value":"/node_id/83af2312-af16-48ef-86f4-2f163ed9dddf","main_metric_percent":0.005066611,"main_metric_per_sec":0.014101401},{"value":"/node_id/610e1f0c-7e33-4d64-a681-8b8de9e6b863","main_metric_percent":0.0050160657,"main_metric_per_sec":0.013960724},{"value":"/node_id/60e648a8-f4ba-40a6-8dfb-2c92815cf903","main_metric_percent":0.0012392468,"main_metric_per_sec":0.003449074},{"value":"/node_id/30b31f4d-5934-4a52-9c8a-3236297de518","main_metric_percent":0.0005572452,"main_metric_per_sec":0.0015509259},{"value":"/node_id/c1cad4ab-4a3c-43b6-b39c-3afb8c0561f7"},{"value":"/node_id/c2987146-faf4-41fa-8f85-f332454e3cbf"},{"value":"/node_id/e5716011-6ce9-48f0-a412-d6b76715f92f"}]},"node_model":{"name":[{"main_metric_percent":1,"main_metric_per_sec":2.783202}]},"node_name":{"name":[{"value":"ps8","main_metric_percent":0.43929195,"main_metric_per_sec":1.2226382},{"value":"pxc57-3","main_metric_percent":0.19586912,"main_metric_per_sec":0.5451433},{"value":"AzureDB-mysql","main_metric_percent":0.113772914,"main_metric_per_sec":0.31665298},{"value":"pxc80-3","main_metric_percent":0.104174264,"main_metric_per_sec":0.289938},{"value":"pxc80-2","main_metric_percent":0.046500746,"main_metric_per_sec":0.12942097},{"value":"mongo-config-2","main_metric_percent":0.030049656,"main_metric_per_sec":0.08363426},{"value":"ps-mysql-8-gr-1","main_metric_percent":0.02050465,"main_metric_per_sec":0.05706858},{"value":"rds-mysql57","main_metric_percent":0.01161455,"main_metric_per_sec":0.032325637},{"value":"ps8-slave","main_metric_percent":0.008947489,"main_metric_per_sec":0.024902668},{"value":"rds-aurora57-instance-1","main_metric_percent":0.006132274,"main_metric_per_sec":0.017067356},{"value":"ps-mysql-8-gr-3","main_metric_percent":0.006119073,"main_metric_per_sec":0.017030615},{"value":"pg11","main_metric_percent":0.0051440895,"main_metric_per_sec":0.01431704},{"value":"ps-mysql-8-gr-2","main_metric_percent":0.005066611,"main_metric_per_sec":0.014101401},{"value":"pg12","main_metric_percent":0.0050160657,"main_metric_per_sec":0.013960724},{"value":"mongo-rs1-2","main_metric_percent":0.0012392468,"main_metric_per_sec":0.003449074},{"value":"mongo-rs2-3","main_metric_percent":0.0005572452,"main_metric_per_sec":0.0015509259},{"value":"mongo-config-1"},{"value":"mongo-config-3"},{"value":"mongos"}]},"node_type":{"name":[{"value":"generic","main_metric_percent":0.8684802,"main_metric_per_sec":2.4171557},{"value":"remote","main_metric_percent":0.113772914,"main_metric_per_sec":0.31665298},{"value":"remote_rds","main_metric_percent":0.017746825,"main_metric_per_sec":0.049392994}]},"region":{"name":[{"main_metric_percent":0.98225313,"main_metric_per_sec":2.7338088},{"value":"us-east-1","main_metric_percent":0.017746825,"main_metric_per_sec":0.049392994}]},"replication_set":{"name":[{"value":"MySQLReplSet1","main_metric_percent":0.44823942,"main_metric_per_sec":1.2475408},{"value":"PXCReplSet1","main_metric_percent":0.19586912,"main_metric_per_sec":0.5451433},{"value":"MySQLReplSet2","main_metric_percent":0.150675,"main_metric_per_sec":0.41935894},{"main_metric_percent":0.14546326,"main_metric_per_sec":0.4048536},{"value":"MongoDBReplSet3","main_metric_percent":0.030049656,"main_metric_per_sec":0.08363426},{"value":"AWSReplSet3","main_metric_percent":0.017746825,"main_metric_per_sec":0.049392994},{"value":"PostgreSQLReplSet1","main_metric_percent":0.010160156,"main_metric_per_sec":0.028277766},{"value":"MongoDBReplSet1","main_metric_percent":0.0012392468,"main_metric_per_sec":0.003449074},{"value":"MongoDBReplSet2","main_metric_percent":0.0005572452,"main_metric_per_sec":0.0015509259}]},"schema":{"name":[{"value":"sbtest1","main_metric_percent":0.3738668,"main_metric_per_sec":1.0405468},{"main_metric_percent":0.2823458,"main_metric_per_sec":0.7858254},{"value":"innodb_3","main_metric_percent":0.19139151,"main_metric_per_sec":0.5326812},{"value":"sys","main_metric_percent":0.12962678,"main_metric_per_sec":0.36077753},{"value":"sbtest","main_metric_percent":0.017922748,"main_metric_per_sec":0.049882624},{"value":"percona","main_metric_percent":0.0048462944,"main_metric_per_sec":0.013488215}]},"service_id":{"name":[{"value":"/service_id/15b9de50-8b34-42ba-85fd-17b19460198b","main_metric_percent":0.43929195,"main_metric_per_sec":1.2226382},{"value":"/service_id/24493995-d914-4f41-b530-bb6f2bb544d0","main_metric_percent":0.19586912,"main_metric_per_sec":0.5451433},{"value":"/service_id/08081762-dffa-4c68-a2f4-5d953b385a53","main_metric_percent":0.113772914,"main_metric_per_sec":0.31665298},{"value":"/service_id/75bd205d-5e46-4697-81b2-446c61c06a87","main_metric_percent":0.104174264,"main_metric_per_sec":0.289938},{"value":"/service_id/fbcd3b2d-a643-4297-a1b5-647bfd6c3c82","main_metric_percent":0.046500746,"main_metric_per_sec":0.12942097},{"value":"/service_id/b0dda75b-5825-4be9-91c6-97761845cf92","main_metric_percent":0.030049656,"main_metric_per_sec":0.08363426},{"value":"/service_id/1b8ff532-9f43-404d-8e8f-bb8bda0aa243","main_metric_percent":0.02050465,"main_metric_per_sec":0.05706858},{"value":"/service_id/97dd18fb-480b-49b1-af12-002888c6ee5e","main_metric_percent":0.01161455,"main_metric_per_sec":0.032325637},{"value":"/service_id/b5b863a0-5032-4207-844d-debfdeb62a5d","main_metric_percent":0.008947489,"main_metric_per_sec":0.024902668},{"value":"/service_id/be2f35a7-512b-44ec-82cc-f5fd980e29fb","main_metric_percent":0.006132274,"main_metric_per_sec":0.017067356},{"value":"/service_id/870c052e-36eb-4644-8bce-9a65e075ae9a","main_metric_percent":0.006119073,"main_metric_per_sec":0.017030615},{"value":"/service_id/dfbc97fc-266f-4374-94d4-44f5faf987ea","main_metric_percent":0.0051440895,"main_metric_per_sec":0.01431704},{"value":"/service_id/db0fe226-de81-4dd0-a23b-51b0ae8fc713","main_metric_percent":0.005066611,"main_metric_per_sec":0.014101401},{"value":"/service_id/c3f0af9b-87d1-4493-906d-f520a57caabb","main_metric_percent":0.0050160657,"main_metric_per_sec":0.013960724},{"value":"/service_id/a0bf892b-931e-4fdd-aee1-566a3682a774","main_metric_percent":0.0012392468,"main_metric_per_sec":0.003449074},{"value":"/service_id/1bce2c11-0375-4ef1-8f7a-befa12e9f66c","main_metric_percent":0.0005572452,"main_metric_per_sec":0.0015509259},{"value":"/service_id/86b91725-be64-442e-a54e-f789da48d4a0"},{"value":"/service_id/eaf962ba-549d-4f2e-8f64-fe184d4ba233"},{"value":"/service_id/f66bfb9f-e00c-43c3-9179-6b0b44d206d0"}]},"service_name":{"name":[{"value":"ps8-mysql","main_metric_percent":0.43929195,"main_metric_per_sec":1.2226382},{"value":"pxc57-3-mysql","main_metric_percent":0.19586912,"main_metric_per_sec":0.5451433},{"value":"AzureDB-mysql","main_metric_percent":0.113772914,"main_metric_per_sec":0.31665298},{"value":"pxc80-3-mysql","main_metric_percent":0.104174264,"main_metric_per_sec":0.289938},{"value":"pxc80-2-mysql","main_metric_percent":0.046500746,"main_metric_per_sec":0.12942097},{"value":"mongo-config-2-mongodb","main_metric_percent":0.030049656,"main_metric_per_sec":0.08363426},{"value":"ps-mysql-8-gr-1","main_metric_percent":0.02050465,"main_metric_per_sec":0.05706858},{"value":"rds-mysql57","main_metric_percent":0.01161455,"main_metric_per_sec":0.032325637},{"value":"ps8-slave-mysql","main_metric_percent":0.008947489,"main_metric_per_sec":0.024902668},{"value":"rds-aurora57-instance-1","main_metric_percent":0.006132274,"main_metric_per_sec":0.017067356},{"value":"ps-mysql-8-gr-3","main_metric_percent":0.006119073,"main_metric_per_sec":0.017030615},{"value":"pg11-postgresql","main_metric_percent":0.0051440895,"main_metric_per_sec":0.01431704},{"value":"ps-mysql-8-gr-2","main_metric_percent":0.005066611,"main_metric_per_sec":0.014101401},{"value":"pg12-postgresql","main_metric_percent":0.0050160657,"main_metric_per_sec":0.013960724},{"value":"mongo-rs1-2-mongodb","main_metric_percent":0.0012392468,"main_metric_per_sec":0.003449074},{"value":"mongo-rs2-3-mongodb","main_metric_percent":0.0005572452,"main_metric_per_sec":0.0015509259},{"value":"mongo-config-1-mongodb"},{"value":"mongo-config-3-mongodb"},{"value":"mongo-mongos"}]},"service_type":{"name":[{"value":"mysql","main_metric_percent":0.9579937,"main_metric_per_sec":2.6662898},{"value":"mongodb","main_metric_percent":0.031846147,"main_metric_per_sec":0.08863426},{"value":"postgresql","main_metric_percent":0.010160156,"main_metric_per_sec":0.028277766}]},"username":{"name":[{"main_metric_percent":0.39092532,"main_metric_per_sec":1.0880241},{"value":"ps8w","main_metric_percent":0.28684807,"main_metric_per_sec":0.7983561},{"value":"sys-schema-dumper","main_metric_percent":0.12962678,"main_metric_per_sec":0.36077753},{"value":"pxc80w","main_metric_percent":0.08579464,"main_metric_per_sec":0.23878382},{"value":"pmm-metrics","main_metric_percent":0.07908841,"main_metric_per_sec":0.22011901},{"value":"pmm_metrics","main_metric_percent":0.010160156,"main_metric_per_sec":0.028277766},{"value":"ps8r","main_metric_percent":0.00576036,"main_metric_per_sec":0.016032245},{"value":"root","main_metric_percent":0.0052931663,"main_metric_per_sec":0.014731951},{"value":"heartbeat","main_metric_percent":0.004834584,"main_metric_per_sec":0.013455623},{"value":"skip-grants user","main_metric_percent":0.001235801,"main_metric_per_sec":0.0034394837},{"value":"proxysql","main_metric_percent":0.0004326312,"main_metric_per_sec":0.0012041},{"value":"repl","main_metric_percent":9.065631e-9,"main_metric_per_sec":2.5231483e-8}]}}}

    return markCheckedLabels(labels, paramLabels);
  },
};
